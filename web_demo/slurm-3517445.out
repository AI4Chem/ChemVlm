2024-05-29 21:25:30 | INFO | model_worker | args: Namespace(host='0.0.0.0', port=10014, worker_address='http://10.140.24.69:10014', controller_address='http://10.140.24.69:10010', model_path='/mnt/hwfile/ai4chem/share/multimodal-exam/internvl_chemllm-llm_lora', model_base=None, model_name='test', device='auto', multi_modal=False, limit_model_concurrency=5, stream_interval=1, no_register=False, load_8bit=False, load_4bit=False)
2024-05-29 21:25:30 | INFO | model_worker | Loading the model test on worker 380ed5 ...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-05-29 21:25:30 | INFO | internvl.model.internvl_chat.configuration_internvl_chat | vision_select_layer: -1
2024-05-29 21:25:30 | INFO | internvl.model.internvl_chat.configuration_internvl_chat | ps_version: v1
2024-05-29 21:25:30 | INFO | internvl.model.internvl_chat.configuration_internvl_chat | min_dynamic_patch: 1
2024-05-29 21:25:30 | INFO | internvl.model.internvl_chat.configuration_internvl_chat | max_dynamic_patch: 6
2024-05-29 21:25:30 | INFO | internvl.model.internvl_chat.modeling_internvl_chat | num_image_token: 256
2024-05-29 21:25:30 | INFO | internvl.model.internvl_chat.modeling_internvl_chat | ps_version: v1
2024-05-29 21:25:34 | INFO | stdout | trainable params: 72,351,744 || all params: 19,933,612,032 || trainable%: 0.3630
2024-05-29 21:25:39 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2024-05-29 21:25:43 | ERROR | stderr | Loading checkpoint shards:   0%|          | 0/11 [00:00<?, ?it/s]
2024-05-29 21:25:45 | ERROR | stderr | Loading checkpoint shards:   9%|▉         | 1/11 [00:02<00:24,  2.47s/it]
2024-05-29 21:25:48 | ERROR | stderr | Loading checkpoint shards:  18%|█▊        | 2/11 [00:04<00:21,  2.43s/it]
2024-05-29 21:25:50 | ERROR | stderr | Loading checkpoint shards:  27%|██▋       | 3/11 [00:07<00:18,  2.31s/it]
2024-05-29 21:25:52 | ERROR | stderr | Loading checkpoint shards:  36%|███▋      | 4/11 [00:09<00:15,  2.28s/it]
2024-05-29 21:25:54 | ERROR | stderr | Loading checkpoint shards:  45%|████▌     | 5/11 [00:11<00:13,  2.25s/it]
2024-05-29 21:25:56 | ERROR | stderr | Loading checkpoint shards:  55%|█████▍    | 6/11 [00:13<00:11,  2.22s/it]
2024-05-29 21:25:59 | ERROR | stderr | Loading checkpoint shards:  64%|██████▎   | 7/11 [00:15<00:08,  2.22s/it]
2024-05-29 21:26:01 | ERROR | stderr | Loading checkpoint shards:  73%|███████▎  | 8/11 [00:18<00:06,  2.20s/it]
2024-05-29 21:26:03 | ERROR | stderr | Loading checkpoint shards:  82%|████████▏ | 9/11 [00:20<00:04,  2.19s/it]
2024-05-29 21:26:05 | ERROR | stderr | Loading checkpoint shards:  91%|█████████ | 10/11 [00:22<00:02,  2.20s/it]
2024-05-29 21:26:06 | ERROR | stderr | Loading checkpoint shards: 100%|██████████| 11/11 [00:23<00:00,  1.82s/it]
2024-05-29 21:26:06 | ERROR | stderr | Loading checkpoint shards: 100%|██████████| 11/11 [00:23<00:00,  2.12s/it]
2024-05-29 21:26:06 | ERROR | stderr | 
2024-05-29 21:26:06 | INFO | model_worker | Register to controller
2024-05-29 21:26:07 | ERROR | stderr | INFO:     Started server process [175624]
2024-05-29 21:26:07 | ERROR | stderr | INFO:     Waiting for application startup.
2024-05-29 21:26:07 | ERROR | stderr | INFO:     Application startup complete.
2024-05-29 21:26:07 | ERROR | stderr | INFO:     Uvicorn running on http://0.0.0.0:10014 (Press CTRL+C to quit)
2024-05-29 21:26:21 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: None. global_counter: 0
2024-05-29 21:26:33 | INFO | stdout | INFO:     10.140.24.69:49696 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:26:36 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: None. global_counter: 0
2024-05-29 21:26:45 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 1
2024-05-29 21:26:45 | INFO | stdout | INFO:     10.140.24.69:49708 - "POST /worker_generate_stream HTTP/1.1" 200 OK
2024-05-29 21:26:45 | INFO | model_worker | max_input_tiles: 12
2024-05-29 21:26:45 | INFO | model_worker | dynamic_image_size: False
2024-05-29 21:26:45 | INFO | model_worker | use_thumbnail: False
2024-05-29 21:26:45 | INFO | model_worker | Resize images to 448x448
2024-05-29 21:26:45 | INFO | model_worker | Split images to torch.Size([1, 3, 448, 448])
2024-05-29 21:26:45 | INFO | model_worker | A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <img><image></img>
请描述这张图片 ASSISTANT:
2024-05-29 21:26:45 | INFO | model_worker | num_image_tokens: 256
2024-05-29 21:26:45 | INFO | model_worker | max_new_tokens: 1024
2024-05-29 21:26:51 | ERROR | stderr | /mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat/internvl/model/internvl_chat/modeling_internvl_chat.py:198: UserWarning: In ps_version 'v1', the height and width have not been swapped back, which results in a transposed image.
2024-05-29 21:26:51 | ERROR | stderr |   warnings.warn("In ps_version 'v1', the height and width have not been swapped back, "
2024-05-29 21:26:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 1
2024-05-29 21:27:01 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 1
2024-05-29 21:27:06 | INFO | stdout | INFO:     10.140.24.69:49726 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:27:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 1
2024-05-29 21:27:15 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 2
2024-05-29 21:27:15 | INFO | stdout | INFO:     10.140.24.69:49740 - "POST /worker_generate_stream HTTP/1.1" 200 OK
2024-05-29 21:27:15 | INFO | model_worker | max_input_tiles: 12
2024-05-29 21:27:15 | INFO | model_worker | dynamic_image_size: False
2024-05-29 21:27:15 | INFO | model_worker | use_thumbnail: False
2024-05-29 21:27:15 | INFO | model_worker | Resize images to 448x448
2024-05-29 21:27:15 | INFO | model_worker | Split images to torch.Size([1, 3, 448, 448])
2024-05-29 21:27:15 | INFO | model_worker | A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <img><image></img>
请描述这张图片 ASSISTANT:
2024-05-29 21:27:15 | INFO | model_worker | num_image_tokens: 256
2024-05-29 21:27:15 | INFO | model_worker | max_new_tokens: 1024
2024-05-29 21:27:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 2
2024-05-29 21:27:37 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 2
2024-05-29 21:27:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 2
2024-05-29 21:28:01 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 2
2024-05-29 21:28:02 | INFO | stdout | INFO:     10.140.24.69:49764 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:28:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 2
2024-05-29 21:28:11 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 3
2024-05-29 21:28:11 | INFO | stdout | INFO:     10.140.24.69:49776 - "POST /worker_generate_stream HTTP/1.1" 200 OK
2024-05-29 21:28:11 | INFO | model_worker | max_input_tiles: 12
2024-05-29 21:28:11 | INFO | model_worker | dynamic_image_size: False
2024-05-29 21:28:11 | INFO | model_worker | use_thumbnail: False
2024-05-29 21:28:11 | INFO | model_worker | Resize images to 448x448
2024-05-29 21:28:11 | INFO | model_worker | Split images to torch.Size([1, 3, 448, 448])
2024-05-29 21:28:11 | INFO | model_worker | A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <img><image></img>
请描述这张图片 ASSISTANT:
2024-05-29 21:28:11 | INFO | model_worker | num_image_tokens: 256
2024-05-29 21:28:11 | INFO | model_worker | max_new_tokens: 1024
2024-05-29 21:28:14 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:28:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:28:37 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:28:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:29:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:29:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:29:37 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:29:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:30:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:30:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:30:37 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:30:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:31:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:31:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:31:27 | INFO | stdout | INFO:     10.140.24.69:49870 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:31:37 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:31:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:32:00 | INFO | stdout | INFO:     10.140.24.69:49888 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:32:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:32:19 | INFO | stdout | INFO:     10.140.24.69:49908 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:32:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 3
2024-05-29 21:32:26 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 4
2024-05-29 21:32:26 | INFO | stdout | INFO:     10.140.24.69:49922 - "POST /worker_generate_stream HTTP/1.1" 200 OK
2024-05-29 21:32:26 | INFO | model_worker | max_input_tiles: 12
2024-05-29 21:32:26 | INFO | model_worker | dynamic_image_size: False
2024-05-29 21:32:26 | INFO | model_worker | use_thumbnail: False
2024-05-29 21:32:26 | INFO | model_worker | Resize images to 448x448
2024-05-29 21:32:26 | INFO | model_worker | Split images to torch.Size([1, 3, 448, 448])
2024-05-29 21:32:26 | INFO | model_worker | A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <img><image></img>
你是谁 ASSISTANT:
2024-05-29 21:32:26 | INFO | model_worker | num_image_tokens: 256
2024-05-29 21:32:26 | INFO | model_worker | max_new_tokens: 1024
2024-05-29 21:32:27 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:32:37 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:32:49 | INFO | stdout | INFO:     10.140.24.69:49944 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:32:52 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:33:07 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:33:22 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:33:23 | INFO | stdout | INFO:     10.140.24.69:49976 - "POST /worker_get_status HTTP/1.1" 200 OK
2024-05-29 21:33:38 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:33:53 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=5, locked=False). global_counter: 4
2024-05-29 21:33:55 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 5
2024-05-29 21:33:56 | INFO | stdout | INFO:     10.140.24.69:50200 - "POST /worker_generate_stream HTTP/1.1" 200 OK
2024-05-29 21:33:56 | INFO | model_worker | max_input_tiles: 12
2024-05-29 21:33:56 | INFO | model_worker | dynamic_image_size: False
2024-05-29 21:33:56 | INFO | model_worker | use_thumbnail: False
2024-05-29 21:33:56 | INFO | model_worker | Resize images to 448x448
2024-05-29 21:33:56 | INFO | model_worker | Split images to torch.Size([1, 3, 448, 448])
2024-05-29 21:33:56 | INFO | model_worker | A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <img><image></img>
请描述这张图片 ASSISTANT:
2024-05-29 21:33:56 | INFO | model_worker | num_image_tokens: 256
2024-05-29 21:33:56 | INFO | model_worker | max_new_tokens: 1024
2024-05-29 21:34:08 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 5
2024-05-29 21:34:23 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 5
2024-05-29 21:34:38 | INFO | model_worker | Send heart beat. Models: ['test']. Semaphore: Semaphore(value=4, locked=False). global_counter: 5
slurmstepd: error: *** JOB 3517445 ON SH-IDC1-10-140-24-69 CANCELLED AT 2024-05-29T21:34:45 ***
2024-05-29 21:34:45 | ERROR | stderr | INFO:     Shutting down
