Traceback (most recent call last):
  File "<frozen runpy>", line 189, in _run_module_as_main
  File "<frozen runpy>", line 112, in _get_module_details
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/__init__.py", line 1, in <module>
    from .model import LlavaLlamaForCausalLM
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/__init__.py", line 1, in <module>
    from .language_model.llava_llama import LlavaLlamaForCausalLM, LlavaConfig
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/language_model/llava_llama.py", line 27, in <module>
    from ..llava_arch import LlavaMetaModel, LlavaMetaForCausalLM
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/llava_arch.py", line 21, in <module>
    from .multimodal_encoder.builder import build_vision_tower
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/multimodal_encoder/builder.py", line 2, in <module>
    from .clip_encoder import CLIPVisionTower
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/multimodal_encoder/clip_encoder.py", line 11, in <module>
    from .internvl_14b.configuration_internvl import InternVLConfig
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/multimodal_encoder/internvl_14b/__init__.py", line 16, in <module>
    from .modeling_internvl import InternVL_C, InternVL_G, InternVLModel
  File "/mnt/petrelfs/zhangdi1/lijunxian/InternVL/internvl_chat_llava/llava/model/multimodal_encoder/internvl_14b/modeling_internvl.py", line 13, in <module>
    from peft import LoraConfig, get_peft_model
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/__init__.py", line 22, in <module>
    from .auto import (
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/auto.py", line 32, in <module>
    from .mapping import MODEL_TYPE_TO_PEFT_MODEL_MAPPING
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/mapping.py", line 22, in <module>
    from .mixed_model import PeftMixedModel
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/mixed_model.py", line 26, in <module>
    from peft.tuners.mixed import COMPATIBLE_TUNER_TYPES
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/tuners/__init__.py", line 26, in <module>
    from .boft import BOFTConfig, BOFTModel
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/tuners/boft/__init__.py", line 16, in <module>
    from .layer import BOFTLayer
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/peft/tuners/boft/layer.py", line 30, in <module>
    from torch.utils.cpp_extension import load
  File "/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/torch/utils/cpp_extension.py", line 25, in <module>
    from pkg_resources import packaging  # type: ignore[attr-defined]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ImportError: cannot import name 'packaging' from 'pkg_resources' (/mnt/petrelfs/zhangdi1/miniforge3/envs/internvl/lib/python3.11/site-packages/pkg_resources/__init__.py)
FlashAttention is not installed.
FlashAttention is not installed.
